{"ast":null,"code":"import axios from \"axios\";\nimport { hideLoader, showLoader } from \"../reduser/appReduser\";\nimport { addFile, deleteFileAction, setFiles } from \"../reduser/fileReduser\";\nimport { addUploadFile, changeUploadFile, hideUploader, showUploader } from \"../reduser/uploadReduser\";\nexport function getFiles(dirId, sort) {\n  const token = localStorage.getItem(\"token\");\n  return async dispatch => {\n    try {\n      dispatch(showLoader());\n      let url = \"http://localhost:4000/api/files\";\n      if (dirId) {\n        url = `http://localhost:4000/api/files?parent=${dirId}`;\n      }\n      if (sort) {\n        url = `http://localhost:4000/api/files?sort=${sort}`;\n      }\n      if (dirId && sort) {\n        url = `http://localhost:4000/api/files?parent=${dirId}&sort=${sort}`;\n      }\n      const response = await axios.get(url, {\n        headers: {\n          Authorization: `Bearer ${token}`\n        }\n      });\n      dispatch(setFiles(response.data));\n    } catch (e) {\n      alert(e.response.data.message);\n    } finally {\n      dispatch(hideLoader());\n    }\n  };\n}\nexport function createDir(dirId, name) {\n  const token = localStorage.getItem(\"token\");\n  return async dispatch => {\n    try {\n      const response = await axios.post(`http://localhost:4000/api/files`, {\n        name,\n        parent: dirId,\n        type: \"dir\"\n      }, {\n        headers: {\n          Authorization: `Bearer ${token}`\n        }\n      });\n      dispatch(addFile(response.data));\n    } catch (e) {\n      alert(e.response.data.message);\n    }\n  };\n}\nexport function uploadFile(dirId, file) {\n  const token = localStorage.getItem(\"token\");\n  return async dispatch => {\n    try {\n      const formData = new FormData();\n      formData.append(\"file\", file);\n      if (dirId) {\n        formData.append(\"parent\", dirId);\n      }\n      const uploadFile = {\n        name: file.name,\n        progress: 0,\n        id: Date.now()\n      };\n      await dispatch(addUploadFile(uploadFile));\n      await dispatch(showUploader());\n      const response = await axios.post(`http://localhost:4000/api/files/upload`, formData, {\n        headers: {\n          Authorization: `Bearer ${token}`\n        },\n        onUploadProgress: progressEvent => {\n          const totalLength = progressEvent.event.lengthComputable ? progressEvent.total : false;\n          if (totalLength) {\n            uploadFile.progress = Math.round(progressEvent.loaded * 100 / totalLength);\n            dispatch(changeUploadFile(uploadFile));\n          }\n        }\n      });\n      dispatch(addFile(response.data));\n    } catch (e) {\n      console.log(e);\n      alert(e.response.data.message);\n    } finally {\n      dispatch(hideUploader());\n    }\n  };\n}\nexport async function downloadfile(file) {\n  const token = localStorage.getItem(\"token\");\n  const response = await fetch(`http://localhost:4000/api/files/download?id=${file._id}`, {\n    headers: {\n      Authorization: `Bearer ${token}`\n    }\n  });\n  if (response.status === 200) {\n    const blob = await response.blob();\n    const downloadUrl = URL.createObjectURL(blob);\n    const link = document.createElement(\"a\");\n    link.setAttribute(\"href\", downloadUrl);\n    link.download = file.name;\n    document.body.append(link);\n    link.click();\n    link.remove();\n  } else {\n    alert(\"Error download\");\n  }\n}\nexport async function deleteFile(file) {\n  const token = localStorage.getItem(\"token\");\n  return async dispatch => {\n    try {\n      const response = await axios.delete(`http://localhost:4000/api/files/delete?id=${file._id}`, {\n        headers: {\n          Authorization: `Bearer ${token}`\n        }\n      });\n      dispatch(deleteFileAction(file._id));\n      alert(response.data.message);\n    } catch (e) {}\n  };\n}\nexport async function searchFile(search) {\n  const token = localStorage.getItem(\"token\");\n  return async dispatch => {\n    try {\n      const response = await axios.get(`http://localhost:4000/api/files/search=${search}`, {\n        headers: {\n          Authorization: `Bearer ${token}`\n        }\n      });\n      dispatch(setFiles(response.data));\n      alert(response.data.message);\n    } catch (e) {}\n  };\n}","map":{"version":3,"names":["axios","hideLoader","showLoader","addFile","deleteFileAction","setFiles","addUploadFile","changeUploadFile","hideUploader","showUploader","getFiles","dirId","sort","token","localStorage","getItem","dispatch","url","response","get","headers","Authorization","data","e","alert","message","createDir","name","post","parent","type","uploadFile","file","formData","FormData","append","progress","id","Date","now","onUploadProgress","progressEvent","totalLength","event","lengthComputable","total","Math","round","loaded","console","log","downloadfile","fetch","_id","status","blob","downloadUrl","URL","createObjectURL","link","document","createElement","setAttribute","download","body","click","remove","deleteFile","delete","searchFile","search"],"sources":["C:/Users/User/Desktop/cloud/client/src/actions/file.js"],"sourcesContent":["import axios from \"axios\";\r\nimport { hideLoader, showLoader } from \"../reduser/appReduser\";\r\nimport { addFile, deleteFileAction, setFiles } from \"../reduser/fileReduser\";\r\nimport {\r\n  addUploadFile,\r\n  changeUploadFile,\r\n  hideUploader,\r\n  showUploader,\r\n} from \"../reduser/uploadReduser\";\r\n\r\nexport function getFiles(dirId, sort) {\r\n  const token = localStorage.getItem(\"token\");\r\n  return async (dispatch) => {\r\n    try {\r\n      dispatch(showLoader());\r\n      let url = \"http://localhost:4000/api/files\";\r\n\r\n      if (dirId) {\r\n        url = `http://localhost:4000/api/files?parent=${dirId}`;\r\n      }\r\n      if (sort) {\r\n        url = `http://localhost:4000/api/files?sort=${sort}`;\r\n      }\r\n\r\n      if (dirId && sort) {\r\n        url = `http://localhost:4000/api/files?parent=${dirId}&sort=${sort}`;\r\n      }\r\n      const response = await axios.get(url, {\r\n        headers: {\r\n          Authorization: `Bearer ${token}`,\r\n        },\r\n      });\r\n      dispatch(setFiles(response.data));\r\n    } catch (e) {\r\n      alert(e.response.data.message);\r\n    } finally {\r\n      dispatch(hideLoader());\r\n    }\r\n  };\r\n}\r\n\r\nexport function createDir(dirId, name) {\r\n  const token = localStorage.getItem(\"token\");\r\n  return async (dispatch) => {\r\n    try {\r\n      const response = await axios.post(\r\n        `http://localhost:4000/api/files`,\r\n        {\r\n          name,\r\n          parent: dirId,\r\n          type: \"dir\",\r\n        },\r\n        {\r\n          headers: { Authorization: `Bearer ${token}` },\r\n        }\r\n      );\r\n      dispatch(addFile(response.data));\r\n    } catch (e) {\r\n      alert(e.response.data.message);\r\n    }\r\n  };\r\n}\r\n\r\nexport function uploadFile(dirId, file) {\r\n  const token = localStorage.getItem(\"token\");\r\n  return async (dispatch) => {\r\n    try {\r\n      const formData = new FormData();\r\n      formData.append(\"file\", file);\r\n      if (dirId) {\r\n        formData.append(\"parent\", dirId);\r\n      }\r\n      const uploadFile = { name: file.name, progress: 0, id: Date.now() };\r\n      await dispatch(addUploadFile(uploadFile));\r\n      await dispatch(showUploader());\r\n      const response = await axios.post(\r\n        `http://localhost:4000/api/files/upload`,\r\n        formData,\r\n        {\r\n          headers: { Authorization: `Bearer ${token}` },\r\n          onUploadProgress: (progressEvent) => {\r\n            const totalLength = progressEvent.event.lengthComputable\r\n              ? progressEvent.total\r\n              : false;\r\n\r\n            if (totalLength) {\r\n              uploadFile.progress = Math.round(\r\n                (progressEvent.loaded * 100) / totalLength\r\n              );\r\n              dispatch(changeUploadFile(uploadFile));\r\n            }\r\n          },\r\n        }\r\n      );\r\n      dispatch(addFile(response.data));\r\n    } catch (e) {\r\n      console.log(e);\r\n      alert(e.response.data.message);\r\n    } finally {\r\n      dispatch(hideUploader());\r\n    }\r\n  };\r\n}\r\n\r\nexport async function downloadfile(file) {\r\n  const token = localStorage.getItem(\"token\");\r\n  const response = await fetch(\r\n    `http://localhost:4000/api/files/download?id=${file._id}`,\r\n    { headers: { Authorization: `Bearer ${token}` } }\r\n  );\r\n\r\n  if (response.status === 200) {\r\n    const blob = await response.blob();\r\n    const downloadUrl = URL.createObjectURL(blob);\r\n    const link = document.createElement(\"a\");\r\n    link.setAttribute(\"href\", downloadUrl);\r\n    link.download = file.name;\r\n    document.body.append(link);\r\n    link.click();\r\n    link.remove();\r\n  } else {\r\n    alert(\"Error download\");\r\n  }\r\n}\r\n\r\nexport async function deleteFile(file) {\r\n  const token = localStorage.getItem(\"token\");\r\n  return async (dispatch) => {\r\n    try {\r\n      const response = await axios.delete(\r\n        `http://localhost:4000/api/files/delete?id=${file._id}`,\r\n        { headers: { Authorization: `Bearer ${token}` } }\r\n      );\r\n      dispatch(deleteFileAction(file._id));\r\n      alert(response.data.message);\r\n    } catch (e) {}\r\n  };\r\n}\r\n\r\nexport async function searchFile(search) {\r\n  const token = localStorage.getItem(\"token\");\r\n  return async (dispatch) => {\r\n    try {\r\n      const response = await axios.get(\r\n        `http://localhost:4000/api/files/search=${search}`,\r\n        { headers: { Authorization: `Bearer ${token}` } }\r\n      );\r\n      dispatch(setFiles(response.data));\r\n      alert(response.data.message);\r\n    } catch (e) {}\r\n  };\r\n}\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}