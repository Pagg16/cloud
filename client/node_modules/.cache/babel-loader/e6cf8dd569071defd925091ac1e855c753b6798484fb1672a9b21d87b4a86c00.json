{"ast":null,"code":"import axios from \"axios\";\nimport { addFile, setFiles } from \"../reduser/fileReduser\";\nexport function getFiles(dirId) {\n  const token = localStorage.getItem(\"token\");\n  return async dispatch => {\n    try {\n      const response = await axios.get(`http://localhost:4000/api/files${dirId ? \"?parent=\" + dirId : \"\"}`, {\n        headers: {\n          Authorization: `Bearer ${token}`\n        }\n      });\n      dispatch(setFiles(response.data));\n    } catch (e) {\n      alert(e.response.data.message);\n    }\n  };\n}\nexport function createDir(dirId, name) {\n  const token = localStorage.getItem(\"token\");\n  return async dispatch => {\n    try {\n      const response = await axios.post(`http://localhost:4000/api/files`, {\n        name,\n        parent: dirId,\n        type: \"dir\"\n      }, {\n        headers: {\n          Authorization: `Bearer ${token}`\n        }\n      });\n      dispatch(addFile(response.data));\n    } catch (e) {\n      alert(e.response.data.message);\n    }\n  };\n}\nexport function uploadFile(dirId, file) {\n  const token = localStorage.getItem(\"token\");\n  return async dispatch => {\n    try {\n      const formData = new FormData();\n      formData.append(\"file\", file);\n      if (dirId) {\n        formData.append(\"parent\", dirId);\n      }\n      const response = await axios.post(`http://localhost:4000/api/files/upload`, formData, {\n        headers: {\n          Authorization: `Bearer ${token}`\n        },\n        onUploadProgress: progressEvent => {\n          const totalLength = progressEvent.event.lengthComputable ? progressEvent.total : false;\n          progressEvent.event.currentTarget.onprogress = e => console.log(e, progressEvent.loaded);\n          if (totalLength) {\n            let progress = Math.round(progressEvent.loaded * 100 / totalLength);\n            // console.log(progressEvent);\n          }\n        }\n      });\n\n      dispatch(addFile(response.data));\n    } catch (e) {\n      alert(e.response.data.message);\n    }\n  };\n}","map":{"version":3,"names":["axios","addFile","setFiles","getFiles","dirId","token","localStorage","getItem","dispatch","response","get","headers","Authorization","data","e","alert","message","createDir","name","post","parent","type","uploadFile","file","formData","FormData","append","onUploadProgress","progressEvent","totalLength","event","lengthComputable","total","currentTarget","onprogress","console","log","loaded","progress","Math","round"],"sources":["C:/Users/User/Desktop/cloud/client/src/actions/file.js"],"sourcesContent":["import axios from \"axios\";\r\nimport { addFile, setFiles } from \"../reduser/fileReduser\";\r\n\r\nexport function getFiles(dirId) {\r\n  const token = localStorage.getItem(\"token\");\r\n  return async (dispatch) => {\r\n    try {\r\n      const response = await axios.get(\r\n        `http://localhost:4000/api/files${dirId ? \"?parent=\" + dirId : \"\"}`,\r\n        {\r\n          headers: {\r\n            Authorization: `Bearer ${token}`,\r\n          },\r\n        }\r\n      );\r\n      dispatch(setFiles(response.data));\r\n    } catch (e) {\r\n      alert(e.response.data.message);\r\n    }\r\n  };\r\n}\r\n\r\nexport function createDir(dirId, name) {\r\n  const token = localStorage.getItem(\"token\");\r\n  return async (dispatch) => {\r\n    try {\r\n      const response = await axios.post(\r\n        `http://localhost:4000/api/files`,\r\n        {\r\n          name,\r\n          parent: dirId,\r\n          type: \"dir\",\r\n        },\r\n        {\r\n          headers: { Authorization: `Bearer ${token}` },\r\n        }\r\n      );\r\n      dispatch(addFile(response.data));\r\n    } catch (e) {\r\n      alert(e.response.data.message);\r\n    }\r\n  };\r\n}\r\n\r\nexport function uploadFile(dirId, file) {\r\n  const token = localStorage.getItem(\"token\");\r\n  return async (dispatch) => {\r\n    try {\r\n      const formData = new FormData();\r\n      formData.append(\"file\", file);\r\n      if (dirId) {\r\n        formData.append(\"parent\", dirId);\r\n      }\r\n      const response = await axios.post(\r\n        `http://localhost:4000/api/files/upload`,\r\n        formData,\r\n        {\r\n          headers: { Authorization: `Bearer ${token}` },\r\n          onUploadProgress: (progressEvent) => {\r\n            const totalLength = progressEvent.event.lengthComputable\r\n              ? progressEvent.total\r\n              : false;\r\n\r\n            progressEvent.event.currentTarget.onprogress = (e) =>\r\n              console.log(e, progressEvent.loaded);\r\n\r\n            if (totalLength) {\r\n              let progress = Math.round(\r\n                (progressEvent.loaded * 100) / totalLength\r\n              );\r\n              // console.log(progressEvent);\r\n            }\r\n          },\r\n        }\r\n      );\r\n      dispatch(addFile(response.data));\r\n    } catch (e) {\r\n      alert(e.response.data.message);\r\n    }\r\n  };\r\n}\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}